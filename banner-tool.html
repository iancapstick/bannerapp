<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banner Planner v1.0 - Make Your Message Heard</title>
    <meta name="description" content="Free tool to help activists create perfect banners based on budget, skills, and timeline. Get custom recommendations for materials and techniques.">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: white;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }
        
        .question-container {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }
        
        .question-container.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(20px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }
        
        .question {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .instruction {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .options {
            display: grid;
            gap: 12px;
        }
        
        .option {
            padding: 16px 24px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 16px;
            font-weight: 500;
            user-select: none;
            position: relative;
            overflow: hidden;
        }
        
        .option::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(52, 152, 219, 0.1);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .option:hover {
            background: #e3f2fd;
            border-color: #3498db;
            transform: translateX(8px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.15);
        }
        
        .option:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .option.selected {
            background: linear-gradient(135deg, #28a745 0%, #20c954 100%);
            color: white;
            border-color: transparent;
            transform: scale(1.02);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.3);
        }
        
        .option:active {
            transform: scale(0.98);
        }
        
        .continue-btn {
            margin-top: 24px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 14px 36px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: none;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .continue-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .continue-btn:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .continue-btn.show {
            display: inline-block;
            animation: slideUp 0.4s ease-out;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .continue-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        
        .progress-bar {
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db 0%, #2ecc71 100%);
            border-radius: 4px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }
        
        .result-container {
            display: none;
            animation: fadeIn 0.6s ease-out;
        }
        
        .result-container.active {
            display: block;
        }
        
        .result-header {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 24px;
            text-align: center;
        }
        
        .user-story {
            background: linear-gradient(135deg, #e3f2fd 0%, #e8f5e9 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            font-size: 16px;
            line-height: 1.8;
            color: #2c3e50;
            border-left: 4px solid #3498db;
        }
        
        .user-story strong {
            color: #1976d2;
            font-weight: 600;
        }
        
        .quick-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .quick-summary h3 {
            font-size: 22px;
            margin-bottom: 16px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .summary-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        .summary-item .label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 4px;
        }
        
        .summary-item .value {
            font-size: 20px;
            font-weight: 700;
        }
        
        .font-detail {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 2px;
        }
        
        .letter-method {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            color: #856404;
        }
        
        .letter-method strong {
            color: #856404;
            display: block;
            margin-bottom: 5px;
        }
        
        .section {
            background: #f8f9fa;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }
        
        .section:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }
        
        .section-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            margin-right: 15px;
            vertical-align: middle;
        }
        
        .section h3 {
            color: #2c3e50;
            margin-bottom: 14px;
            font-size: 20px;
            font-weight: 600;
            display: inline-block;
            vertical-align: middle;
        }
        
        .section p {
            color: #555;
            margin-bottom: 8px;
        }
        
        .section ul {
            margin-left: 20px;
            color: #555;
        }
        
        .section li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
        
        .checklist {
            background: white;
            border: 2px dashed #3498db;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .checklist-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
        }
        
        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
        }
        
        .checklist-item label {
            cursor: pointer;
            user-select: none;
        }
        
        .tip-category {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .tip-category:hover {
            border-color: #3498db;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.1);
        }
        
        .tip-category h4 {
            color: #495057;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tip-category-icon {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .product-highlight {
            background: #e7f3ff;
            border-left: 3px solid #3498db;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 0 6px 6px 0;
            font-size: 14px;
        }
        
        .product-highlight strong {
            color: #1976d2;
        }
        
        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 32px;
        }
        
        .btn {
            border: none;
            padding: 14px 24px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }
        
        .btn-info {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(23, 162, 184, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }
        
        .back-btn {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 24px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(108, 117, 125, 0.3);
        }
        
        .back-btn:hover {
            transform: translateX(-4px);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.4);
        }
        
        /* Copy notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 16px 24px;
            border-radius: 10px;
            display: none;
            animation: slideIn 0.4s ease;
            box-shadow: 0 4px 20px rgba(46, 204, 113, 0.4);
            font-weight: 600;
        }
        
        .notification.show {
            display: block;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @media (max-width: 600px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            
            h1 {
                font-size: 28px;
            }
            
            .question {
                font-size: 20px;
            }
            
            .option {
                padding: 14px 18px;
                font-size: 15px;
            }
            
            .button-group {
                grid-template-columns: 1fr;
            }
            
            .summary-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media print {
            .button-group {
                display: none;
            }
            
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            
            .section {
                break-inside: avoid;
            }
            
            .quick-summary {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Banner Planner</h1>
        <p class="subtitle">Answer a few questions to get personalized recommendations for your activist banner</p>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>
        
        <div id="quiz-container">
            <!-- Question containers will be dynamically shown/hidden -->
        </div>
        
        <div id="result-container" class="result-container">
            <!-- Results will be displayed here -->
        </div>
    </div>
    
    <div class="notification" id="notification"></div>

    <script>
        const questions = [
            {
                id: 'budget',
                question: "What's your budget?",
                multiSelect: false,
                options: [
                    { value: 'minimal', text: 'DIY/Minimal (under $20)' },
                    { value: 'low', text: 'Low budget ($20-50)' },
                    { value: 'moderate', text: 'Moderate budget ($50-150)' },
                    { value: 'higher', text: 'Higher budget ($150+)' }
                ]
            },
            {
                id: 'skills',
                question: 'What skills do you have available?',
                multiSelect: true,
                instruction: 'Select all that apply',
                options: [
                    { value: 'sewers', text: 'Sewers/quilters' },
                    { value: 'painters', text: 'Painters/artists' },
                    { value: 'screen', text: 'Screen printers/vinyl cutters' },
                    { value: 'digital', text: 'Graphic designers' },
                    { value: 'basic', text: 'Basic only' },
                    { value: 'mixed', text: 'Mixed group' }
                ]
            },
            {
                id: 'tools',
                question: 'What tools/equipment can you access?',
                multiSelect: true,
                instruction: 'Select all that apply',
                options: [
                    { value: 'sewing', text: 'Sewing machines & fabric tools' },
                    { value: 'paint', text: 'Paint supplies (brushes, rollers, spray)' },
                    { value: 'printers', text: 'Large printers/plotters' },
                    { value: 'projectors', text: 'Projectors (for tracing)' },
                    { value: 'screen-print', text: 'Screen printing setup' },
                    { value: 'vinyl', text: 'Vinyl cutter (Cricut/Silhouette)' },
                    { value: 'household', text: 'Just basic household items' },
                    { value: 'makerspace', text: 'Maker space/full workshop' }
                ]
            },
            {
                id: 'display',
                question: 'What type of action/display?',
                multiSelect: false,
                options: [
                    { value: 'march', text: 'March/parade (portable)' },
                    { value: 'rally', text: 'Rally/stationary' },
                    { value: 'drop', text: 'Banner drop' },
                    { value: 'street', text: 'Street spanning' },
                    { value: 'blockade', text: 'Blockade/ground' },
                    { value: 'window', text: 'Window/fence' },
                    { value: 'indoor', text: 'Indoor display banner' },
                    { value: 'art', text: 'Art piece/installation' }
                ]
            },
            {
                id: 'timeline',
                question: 'Timeline?',
                multiSelect: false,
                options: [
                    { value: 'emergency', text: 'Emergency (hours)' },
                    { value: 'quick', text: 'Quick (1-2 days)' },
                    { value: 'standard', text: 'Standard (3-7 days)' },
                    { value: 'planned', text: 'Planned (week+)' }
                ]
            },
            {
                id: 'weather',
                question: 'Expected weather conditions?',
                multiSelect: false,
                options: [
                    { value: 'indoor', text: 'Indoor only' },
                    { value: 'sunny', text: 'Sunny/dry' },
                    { value: 'maybe-rain', text: 'Possible rain' },
                    { value: 'rain', text: 'Definite rain/storm' },
                    { value: 'wind', text: 'Wind expected' },
                    { value: 'snow', text: 'Snow/cold' },
                    { value: 'unknown', text: 'Unknown/various' }
                ]
            },
            {
                id: 'size',
                question: 'Size/carriers?',
                multiSelect: false,
                options: [
                    { value: 'solo', text: 'Solo' },
                    { value: 'small', text: 'Small group (2-4)' },
                    { value: 'medium', text: 'Medium group (5-10)' },
                    { value: 'large', text: 'Large group (10+)' }
                ]
            },
            {
                id: 'durability',
                question: 'Durability needs?',
                multiSelect: false,
                options: [
                    { value: 'single', text: 'Single use' },
                    { value: 'multiple', text: 'Multiple events' },
                    { value: 'weather', text: 'Weather resistant' },
                    { value: 'longterm', text: 'Long-term' }
                ]
            }
        ];

        let currentQuestion = 0;
        let answers = {};

        function initializeQuiz() {
            const container = document.getElementById('quiz-container');
            
            // Create all question containers
            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-container';
                questionDiv.id = `question-${index}`;
                
                let html = '';
                if (index > 0) {
                    html += `<button class="back-btn" onclick="goBack()">← Back</button>`;
                }
                
                html += `<h2 class="question">${q.question}</h2>`;
                
                if (q.instruction) {
                    html += `<p class="instruction">${q.instruction}</p>`;
                }
                
                html += '<div class="options">';
                
                q.options.forEach(option => {
                    if (q.multiSelect) {
                        html += `<div class="option" id="${q.id}-${option.value}" onclick="toggleAnswer('${q.id}', '${option.value}')">${option.text}</div>`;
                    } else {
                        html += `<div class="option" onclick="selectAnswer('${q.id}', '${option.value}')">${option.text}</div>`;
                    }
                });
                
                html += '</div>';
                
                if (q.multiSelect) {
                    html += `<button class="continue-btn" id="continue-${index}" onclick="continueFromMulti()">Continue →</button>`;
                }
                
                questionDiv.innerHTML = html;
                container.appendChild(questionDiv);
            });
            
            // Show first question
            showQuestion(0);
        }

        function sendHeight() {
            // Send height to parent window if embedded
            if (window.parent !== window) {
                const height = document.body.scrollHeight;
                window.parent.postMessage({ 
                    type: 'bannerToolHeight', 
                    height: height 
                }, '*');
            }
        }

        function showQuestion(index) {
            // Hide all questions
            document.querySelectorAll('.question-container').forEach(q => {
                q.classList.remove('active');
            });
            
            // Show current question
            document.getElementById(`question-${index}`).classList.add('active');
            
            // Update progress bar
            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progress').style.width = progress + '%';
            
            // Send height update
            setTimeout(sendHeight, 100);
        }

        function selectAnswer(questionId, value) {
            answers[questionId] = value;
            
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                showResults();
            }
        }

        function toggleAnswer(questionId, value) {
            if (!answers[questionId]) {
                answers[questionId] = [];
            }
            
            const element = document.getElementById(`${questionId}-${value}`);
            
            if (answers[questionId].includes(value)) {
                answers[questionId] = answers[questionId].filter(v => v !== value);
                element.classList.remove('selected');
            } else {
                answers[questionId].push(value);
                element.classList.add('selected');
            }
            
            // Show/hide continue button
            const continueBtn = document.getElementById(`continue-${currentQuestion}`);
            if (answers[questionId].length > 0) {
                continueBtn.classList.add('show');
            } else {
                continueBtn.classList.remove('show');
            }
        }

        function continueFromMulti() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                showResults();
            }
        }

        function goBack() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        function getLetterCreationMethod(points) {
            const pt = parseInt(points);
            if (pt < 400) {
                return {
                    tool: "Google Docs or Microsoft Word",
                    method: "Type your text and increase font size to maximum (usually 96pt), then scale up when printing"
                };
            } else if (pt >= 400 && pt <= 800) {
                return {
                    tool: "Canva (free) or Photoshop",
                    method: "Create a custom canvas size matching your banner dimensions and design at full scale"
                };
            } else {
                return {
                    tool: "Projector required",
                    method: "Project your text onto the banner material and trace. For best results, darken the room and use a bright projector"
                };
            }
        }

        function calculateBannerSpecs() {
            let width, height, fontSize, fontSizePoints, textRange, readableDistance;
            
            // Check for solo FIRST, as it overrides display type for sizing
            if (answers.size === 'solo') {
                // Standard poster board size for ANY solo banner
                width = { inches: 22, cm: 56 };
                height = { inches: 28, cm: 71 };
                fontSize = "3-4\" (7.5-10cm)";
                fontSizePoints = 288; // Using max for letter creation
                textRange = "10-15";
                readableDistance = "20-40 feet";
            } else if (answers.display === 'march' || answers.display === 'rally') {
                if (answers.size === 'small') {
                    width = { inches: 72, cm: 183 };
                    height = { inches: 36, cm: 91 };
                    fontSize = "6-8\" (15-20cm)";
                    fontSizePoints = 576;
                    textRange = "20-30";
                    readableDistance = "50-100 feet";
                } else if (answers.size === 'medium') {
                    width = { inches: 96, cm: 244 };
                    height = { inches: 48, cm: 122 };
                    fontSize = "8-10\" (20-25cm)";
                    fontSizePoints = 720;
                    textRange = "30-40";
                    readableDistance = "100-150 feet";
                } else {
                    width = { inches: 120, cm: 305 };
                    height = { inches: 60, cm: 152 };
                    fontSize = "10-12\" (25-30cm)";
                    fontSizePoints = 864;
                    textRange = "40-50";
                    readableDistance = "150-200 feet";
                }
            } else if (answers.display === 'drop') {
                if (answers.budget === 'minimal') {
                    width = { inches: 72, cm: 183 };
                    height = { inches: 120, cm: 305 };
                } else {
                    width = { inches: 120, cm: 305 };
                    height = { inches: 240, cm: 610 };
                }
                fontSize = "12-18\" (30-45cm)";
                fontSizePoints = 1296;
                textRange = "35-45";
                readableDistance = "200-300 feet";
            } else if (answers.display === 'street') {
                width = { inches: 240, cm: 610 };
                height = { inches: 48, cm: 122 };
                fontSize = "10-14\" (25-35cm)";
                fontSizePoints = 1008;
                textRange = "50-60";
                readableDistance = "150-250 feet";
            } else if (answers.display === 'indoor' || answers.display === 'art') {
                width = { inches: 60, cm: 152 };
                height = { inches: 36, cm: 91 };
                fontSize = "3-5\" (7.5-12.5cm)";
                fontSizePoints = 360;
                textRange = "40-50";
                readableDistance = "20-40 feet";
            } else {
                // Default sizes
                width = { inches: 72, cm: 183 };
                height = { inches: 36, cm: 91 };
                fontSize = "6-8\" (15-20cm)";
                fontSizePoints = 576;
                textRange = "25-35";
                readableDistance = "50-100 feet";
            }
            
            return { width, height, fontSize, fontSizePoints, textRange, readableDistance };
        }

        function createUserNarrative() {
            const budget = questions[0].options.find(o => o.value === answers.budget)?.text.toLowerCase() || '';
            const skills = answers.skills ? answers.skills.map(s => 
                questions[1].options.find(o => o.value === s)?.text.toLowerCase()
            ).join(', ') : 'basic skills';
            const display = questions[3].options.find(o => o.value === answers.display)?.text.toLowerCase() || '';
            const timeline = questions[4].options.find(o => o.value === answers.timeline)?.text.toLowerCase() || '';
            const weather = questions[5].options.find(o => o.value === answers.weather)?.text.toLowerCase() || '';
            const size = questions[6].options.find(o => o.value === answers.size)?.text.toLowerCase() || '';
            const durability = questions[7].options.find(o => o.value === answers.durability)?.text.toLowerCase() || '';
            
            let narrative = `You're planning a <strong>${display}</strong> banner for <strong>${size}</strong> carriers `;
            narrative += `with a <strong>${budget}</strong> budget. `;
            narrative += `You have <strong>${skills}</strong> available `;
            narrative += `and need it ready in <strong>${timeline}</strong>. `;
            narrative += `The banner will face <strong>${weather}</strong> conditions `;
            narrative += `and needs <strong>${durability}</strong> durability.`;
            
            return narrative;
        }

        function generateRecommendation() {
            let materials = [];
            let methods = [];
            let tips = {};
            const specs = calculateBannerSpecs();
            
            // Initialize tip categories
            tips.lettering = [];
            tips.construction = [];
            tips.weatherproofing = [];
            tips.finishing = [];
            
            // BUDGET-APPROPRIATE MATERIALS
            if (answers.budget === 'minimal') {
                // Solo-specific materials first
                if (answers.size === 'solo') {
                    materials.push('Standard poster board (22"×28" / 56×71cm) from dollar store ($1-2)');
                    materials.push('Corrugated plastic yard signs (free from recycling)');
                }
                materials.push('Old bedsheets (free from thrift stores)');
                materials.push('Cardboard from appliance boxes');
                materials.push('House paint leftovers or cheap tempera paint');
                materials.push('Glue sticks for paper letter placement');
                materials.push('Double-sided tape or spray adhesive');
                
                if (answers.timeline !== 'emergency') {
                    materials.push('Paper grocery bags (iron flat and tape together)');
                }
                // Add quilting cotton for sewers
                if (answers.skills && answers.skills.includes('sewers')) {
                    materials.push('Quilting cotton scraps (often available free from quilters)');
                }
            } else if (answers.budget === 'low') {
                if (answers.size === 'solo') {
                    materials.push('Professional poster board or foam core');
                    materials.push('Corrugated plastic sheets');
                }
                materials.push('Canvas drop cloths ($10-15 at hardware stores)');
                materials.push('Acrylic craft paint ($1-2 per bottle)');
                materials.push('Foam core boards for structure');
                materials.push('Pre-made letter stencils from craft stores ($5-15)');
                materials.push('Tacky glue (Aleene\'s) for heavier materials');
                materials.push('Spray adhesive (3M Super 77) for professional finish');
                
                if (answers.skills && answers.skills.includes('sewers')) {
                    materials.push('Quilting cotton from fabric stores ($5-8/yard on sale)');
                    materials.push('Fusible web (Wonder Under or Heat n Bond Lite) ($3-5)');
                }
            } else if (answers.budget === 'moderate') {
                materials.push('Banner vinyl ($30-50 for 4\'×8\' / 122×244cm)');
                materials.push('Ripstop nylon fabric');
                materials.push('Professional fabric paint or screen printing ink');
                materials.push('Grommets and grommet tool');
                materials.push('Professional letter stencils or custom-cut templates');
                materials.push('Heavy-duty fusible web (Heat n Bond Ultra Hold)');
                materials.push('Craft adhesive (E6000) for heavy-duty bonding');
                
                if (answers.skills && answers.skills.includes('sewers')) {
                    materials.push('Quality quilting cotton or canvas');
                    materials.push('Double stick fusible web (Steam-a-Seam 2)');
                }
            } else {
                materials.push('Professional banner material with hem and grommets');
                materials.push('Heavy-duty vinyl or mesh banner');
                materials.push('Digital printing services ($10-20 per sq ft)');
                materials.push('Professional sign vinyl for lettering');
                materials.push('Vinyl application tools (squeegee, transfer tape)');
                materials.push('Professional adhesives and heat press equipment');
            }
            
            // SKILL-SPECIFIC METHODS AND VINYL CUTTER SUPPORT
            if (answers.skills && answers.skills.includes('sewers')) {
                if (answers.budget === 'minimal' || answers.budget === 'low') {
                    methods.push('Patchwork technique: sew together fabric scraps in a quilt pattern');
                    methods.push('Raw-edge appliqué: cut letters from contrasting fabric, zigzag stitch edges');
                    methods.push('Reverse appliqué: cut letters out to reveal contrasting fabric beneath');
                } else {
                    methods.push('Professional appliqué with satin stitch finish');
                    methods.push('Fabric collage with fusible webbing');
                    methods.push('3D fabric letters stuffed with batting');
                    methods.push('Embroidered details for emphasis');
                }
                
                // Sewing-specific tips organized by category
                tips.construction.push('Use a walking foot for thick layers');
                tips.construction.push('Baste layers before final stitching');
                tips.finishing.push('French seams for professional finish on lightweight fabrics');
                tips.finishing.push('Flat-fell seams for heavy-duty construction');
                tips.construction.push('Pre-wash all fabrics to prevent shrinking');
            }
            
            if (answers.skills && answers.skills.includes('painters')) {
                if (answers.timeline === 'emergency') {
                    methods.push('Freehand painting with wide brushes');
                    methods.push('Spray paint with cardboard stencils');
                } else {
                    methods.push('Grid method: scale up design using grid squares');
                    methods.push('Projector tracing for perfect lettering');
                    methods.push('Sign painting technique with liner brushes');
                    methods.push('Gradient/ombré backgrounds with sponges');
                }
                
                // Painting tips by category
                tips.lettering.push('Use painter\'s tape for crisp letter edges');
                tips.lettering.push('Apply multiple thin coats rather than one thick coat');
                tips.construction.push('Prime fabric with gesso for better paint adhesion');
                tips.finishing.push('Seal painted areas with acrylic medium for durability');
            }
            
            // Check for vinyl cutter access
            if (answers.tools && answers.tools.includes('vinyl')) {
                methods.push('Cut vinyl letters for professional appearance');
                methods.push('Heat transfer vinyl (HTV) for fabric banners');
                methods.push('Adhesive vinyl for rigid surfaces');
                tips.lettering.push('Weed vinyl carefully with weeding tools');
                tips.lettering.push('Use transfer tape for precise letter placement');
                tips.lettering.push('Apply vinyl from center outward to avoid bubbles');
            }
            
            // LETTERING TIPS based on budget
            if (answers.budget === 'minimal') {
                tips.lettering.push('Cut letters from contrasting colored paper or fabric');
                tips.lettering.push('Use glue sticks for repositionable placement before final adhesion');
            } else if (answers.budget === 'low' || answers.budget === 'moderate') {
                tips.lettering.push('Buy pre-made stencils for consistent lettering');
                tips.lettering.push('Use spray adhesive on back of letters for smooth application');
                tips.lettering.push('Apply letters from center outward to avoid bubbles');
            } else {
                tips.lettering.push('Use professional vinyl lettering for perfect results');
                tips.lettering.push('Apply transfer tape for precise letter spacing');
            }
            
            if (answers.skills && answers.skills.includes('screen')) {
                methods.push('Photo emulsion screens for detailed designs');
                methods.push('Paper stencil method for quick screens');
                methods.push('Multi-color registration printing');
                tips.lettering.push('Flood screen between prints for consistency');
                tips.construction.push('Use squeegee at 45-degree angle');
                tips.finishing.push('Heat-set prints at 320°F (160°C) for 30 seconds');
                
                // If they have screen printing AND vinyl cutter
                if (answers.tools && answers.tools.includes('vinyl')) {
                    methods.push('Use vinyl cutter to create screen printing stencils');
                    tips.lettering.push('Cut vinyl stencils for precise screen printing registration');
                }
            }
            
            if (answers.skills && answers.skills.includes('digital')) {
                if (answers.budget === 'moderate' || answers.budget === 'higher') {
                    methods.push('Design in vector format for scalability');
                    methods.push('Create print-ready files at actual size');
                    if (answers.tools && answers.tools.includes('vinyl')) {
                        methods.push('Export designs for vinyl cutting');
                    }
                } else {
                    methods.push('Tile printing: print on multiple sheets and assemble');
                    methods.push('Design templates for hand-painting guides');
                }
            }
            
            // DISPLAY-SPECIFIC CONSTRUCTION
            if (answers.display === 'march') {
                if (answers.size === 'solo') {
                    tips.construction.push('Use paint stir sticks or 1/2" (1.3cm) dowels for handles');
                    tips.construction.push('Attach handle to back center with duct tape or hot glue');
                    tips.construction.push('Consider double-sided design for 360° visibility');
                    tips.construction.push('Keep total weight under 2 lbs (0.9kg) for comfort');
                } else if (answers.size === 'small') {
                    tips.construction.push('Mark hand positions with colored tape');
                    tips.construction.push('Use PVC connectors for modular assembly');
                    tips.construction.push('Distribute weight evenly among carriers');
                } else {
                    tips.construction.push('Use PVC pipe frame for larger banners');
                    tips.construction.push('Add corner reinforcements');
                    tips.construction.push('Consider wheels for very large banners');
                }
            } else if (answers.display === 'drop') {
                tips.construction.push('Reinforced top pocket for 2" (5cm) PVC pipe or rope');
                tips.construction.push('Bottom hem with chain or rebar for weight');
                tips.construction.push('Quick-release system with carabiners');
                tips.construction.push('Practice deployment with smaller test banner');
            } else if (answers.display === 'street') {
                tips.construction.push('Use aircraft cable for spanning');
                tips.construction.push('Add corner reinforcements with webbing');
                tips.construction.push('Include safety breakaway if over traffic');
            }
            
            // WEATHER-SPECIFIC CONSTRUCTION
            if (answers.weather === 'indoor') {
                tips.weatherproofing.push('No weatherproofing needed - focus on aesthetics');
                tips.weatherproofing.push('Can use delicate materials like tissue paper or thin fabrics');
            } else if (answers.weather === 'rain' || answers.weather === 'maybe-rain') {
                if (answers.budget === 'minimal') {
                    tips.weatherproofing.push('Clear packing tape over paper elements');
                    tips.weatherproofing.push('Garbage bags as emergency rain covers');
                } else {
                    tips.weatherproofing.push('Marine-grade thread for all seams');
                    tips.weatherproofing.push('Silicone spray for water repellency');
                    tips.weatherproofing.push('Heat-sealed edges on synthetic materials');
                }
            }
            
            if (answers.weather === 'wind') {
                tips.weatherproofing.push('Wind slits: 6" (15cm) curved cuts every 3 feet (91cm)');
                tips.weatherproofing.push('Reinforce all stress points with webbing');
                tips.weatherproofing.push('Use bungee cords instead of rigid attachments');
            }
            
            // TIMELINE-BASED METHODS
            if (answers.timeline === 'emergency') {
                methods.push('Pre-cut vinyl letters from sign shop');
                methods.push('Duct tape lettering on contrasting background');
                methods.push('Sharpie markers on light-colored fabric');
                tips.construction.push('Assign each person one letter to create');
                tips.construction.push('Use hair dryers or fans to speed drying');
            } else if (answers.timeline === 'planned') {
                tips.construction.push('Test materials and methods first');
                tips.construction.push('Create templates for consistent lettering');
                tips.finishing.push('Document process for future banners');
            }
            
            // DURABILITY-SPECIFIC
            if (answers.durability === 'weather' || answers.durability === 'longterm') {
                if (answers.budget !== 'minimal') {
                    tips.weatherproofing.push('UV-resistant clear coat on all painted areas');
                    tips.finishing.push('Double-hem all edges with bonded polyester thread');
                    tips.finishing.push('Brass grommets (not aluminum) for longevity');
                    tips.finishing.push('Store in tube, never folded');
                }
            }
            
            // General tips always included
            tips.lettering.push('Block letters with drop shadows for visibility');
            tips.lettering.push('High contrast between text and background');
            tips.construction.push('Use chalk or pencil to sketch before committing');
            tips.finishing.push('Take photos from distance to check readability');
            
            return { materials, methods, tips, specs };
        }

        function formatUserSelections() {
            let selections = {};
            
            questions.forEach(q => {
                if (answers[q.id]) {
                    const answer = answers[q.id];
                    if (Array.isArray(answer)) {
                        const selectedTexts = answer.map(val => 
                            q.options.find(opt => opt.value === val)?.text || val
                        );
                        selections[q.question] = selectedTexts.join(', ');
                    } else {
                        selections[q.question] = q.options.find(opt => opt.value === answer)?.text || answer;
                    }
                }
            });
            
            return selections;
        }

        function showResults() {
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('progress').style.width = '100%';
            
            const recommendation = generateRecommendation();
            const userSelections = formatUserSelections();
            const resultContainer = document.getElementById('result-container');
            const letterMethod = getLetterCreationMethod(recommendation.specs.fontSizePoints);
            const userNarrative = createUserNarrative();
            
            let html = '<h2 class="result-header">✊ Your Custom Banner Guide</h2>';
            
            // User narrative summary
            html += `<div class="user-story">${userNarrative}</div>`;
            
            // Quick summary with key specs
            html += `
                <div class="quick-summary">
                    <h3>Banner Specifications</h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="label">Size</div>
                            <div class="value">${recommendation.specs.width.inches}"×${recommendation.specs.height.inches}"</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Font Size</div>
                            <div class="value">${recommendation.specs.fontSize}</div>
                            <div class="font-detail">${recommendation.specs.fontSizePoints < 400 ? 'Under 400pt' : recommendation.specs.fontSizePoints + 'pt'}</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Text Length</div>
                            <div class="value">${recommendation.specs.textRange} chars</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Visible At</div>
                            <div class="value">${recommendation.specs.readableDistance}</div>
                        </div>
                    </div>
                    <div class="letter-method">
                        <strong>Letter Creation Method:</strong>
                        Use ${letterMethod.tool} - ${letterMethod.method}
                    </div>
                </div>
            `;
            
            // Materials Shopping List
            html += `
                <div class="section">
                    <div class="section-icon">🛍️</div>
                    <h3>Shopping List</h3>
                    <div class="checklist">
            `;
            recommendation.materials.forEach((m, idx) => {
                const checkId = `mat-${idx}`;
                html += `
                    <div class="checklist-item">
                        <input type="checkbox" id="${checkId}">
                        <label for="${checkId}">${m}</label>
                    </div>
                `;
            });
            html += '</div></div>';
            
            // Creation Methods
            html += `
                <div class="section">
                    <div class="section-icon">🎨</div>
                    <h3>How to Make It</h3>
                    <ul>
            `;
            recommendation.methods.forEach(m => {
                html += `<li>${m}</li>`;
            });
            html += '</ul></div>';
            
            // Organized Pro Tips
            html += `
                <div class="section">
                    <div class="section-icon">💡</div>
                    <h3>Pro Tips</h3>
            `;
            
            // Lettering Tips
            if (recommendation.tips.lettering.length > 0) {
                html += `
                    <div class="tip-category">
                        <h4><span class="tip-category-icon">✏️</span> Lettering & Design</h4>
                        <ul>
                `;
                recommendation.tips.lettering.forEach(t => {
                    html += `<li>${t}</li>`;
                });
                html += '</ul></div>';
            }
            
            // Construction Tips
            if (recommendation.tips.construction.length > 0) {
                html += `
                    <div class="tip-category">
                        <h4><span class="tip-category-icon">🔨</span> Construction</h4>
                        <ul>
                `;
                recommendation.tips.construction.forEach(t => {
                    html += `<li>${t}</li>`;
                });
                html += '</ul></div>';
            }
            
            // Weatherproofing Tips
            if (recommendation.tips.weatherproofing.length > 0) {
                html += `
                    <div class="tip-category">
                        <h4><span class="tip-category-icon">☔</span> Weatherproofing</h4>
                        <ul>
                `;
                recommendation.tips.weatherproofing.forEach(t => {
                    html += `<li>${t}</li>`;
                });
                html += '</ul></div>';
            }
            
            // Finishing Tips
            if (recommendation.tips.finishing.length > 0) {
                html += `
                    <div class="tip-category">
                        <h4><span class="tip-category-icon">✨</span> Finishing Touches</h4>
                        <ul>
                `;
                recommendation.tips.finishing.forEach(t => {
                    html += `<li>${t}</li>`;
                });
                html += '</ul></div>';
            }
            
            html += '</div>'; // Close section
            
            // Action buttons
            html += `
                <div class="button-group">
                    <button class="btn btn-primary" onclick="window.print()">
                        <span>📄</span> Print Guide
                    </button>
                    <button class="btn btn-success" onclick="saveAsText()">
                        <span>💾</span> Save Text
                    </button>
                    <button class="btn btn-info" onclick="copyToClipboard()">
                        <span>📋</span> Copy
                    </button>
                    <button class="btn btn-info" onclick="shareViaEmail()">
                        <span>✉️</span> Email
                    </button>
                    <button class="btn btn-secondary" onclick="restart()">
                        <span>🔄</span> Start Over
                    </button>
                </div>
            `;
            
            resultContainer.innerHTML = html;
            resultContainer.classList.add('active');
            
            // Send height update
            setTimeout(sendHeight, 100);
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function getResultsContent() {
            const recommendation = generateRecommendation();
            const userSelections = formatUserSelections();
            const date = new Date().toLocaleDateString();
            const letterMethod = getLetterCreationMethod(recommendation.specs.fontSizePoints);
            const userNarrative = createUserNarrative();
            
            return {
                date: date,
                selections: userSelections,
                specs: recommendation.specs,
                materials: recommendation.materials,
                methods: recommendation.methods,
                tips: recommendation.tips,
                letterMethod: letterMethod,
                narrative: userNarrative.replace(/<[^>]*>/g, '') // Strip HTML for text output
            };
        }

        function saveAsText() {
            const content = getResultsContent();
            let text = `BANNER CREATION GUIDE - Generated ${content.date}\n`;
            text += `${'='.repeat(50)}\n\n`;
            
            text += "YOUR PROJECT:\n";
            text += `${content.narrative}\n\n`;
            
            text += "QUICK SPECS:\n";
            text += `• Size: ${content.specs.width.inches}" × ${content.specs.height.inches}" (${content.specs.width.cm}cm × ${content.specs.height.cm}cm)\n`;
            text += `• Font Size: ${content.specs.fontSize}\n`;
            text += `• Text Length: ${content.specs.textRange} characters\n`;
            text += `• Readable Distance: ${content.specs.readableDistance}\n`;
            text += `• Letter Creation: ${content.letterMethod.tool} - ${content.letterMethod.method}\n\n`;
            
            text += "SHOPPING LIST:\n";
            content.materials.forEach(m => {
                text += `□ ${m}\n`;
            });
            
            text += "\nCREATION METHODS:\n";
            content.methods.forEach((m, i) => {
                text += `${i + 1}. ${m}\n`;
            });
            
            text += "\nPRO TIPS:\n";
            
            // Organize tips by category for text output
            if (content.tips.lettering && content.tips.lettering.length > 0) {
                text += "\nLettering & Design:\n";
                content.tips.lettering.forEach(t => {
                    text += `• ${t}\n`;
                });
            }
            
            if (content.tips.construction && content.tips.construction.length > 0) {
                text += "\nConstruction:\n";
                content.tips.construction.forEach(t => {
                    text += `• ${t}\n`;
                });
            }
            
            if (content.tips.weatherproofing && content.tips.weatherproofing.length > 0) {
                text += "\nWeatherproofing:\n";
                content.tips.weatherproofing.forEach(t => {
                    text += `• ${t}\n`;
                });
            }
            
            if (content.tips.finishing && content.tips.finishing.length > 0) {
                text += "\nFinishing Touches:\n";
                content.tips.finishing.forEach(t => {
                    text += `• ${t}\n`;
                });
            }
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `banner-guide-${content.date.replace(/\//g, '-')}.txt`;
            a.click();
            window.URL.revokeObjectURL(url);
            showNotification('✓ Downloaded!');
        }

        function copyToClipboard() {
            const content = getResultsContent();
            let text = `BANNER SPECS: ${content.specs.width.inches}"×${content.specs.height.inches}" | Font: ${content.specs.fontSize} | ${content.specs.textRange} chars\n`;
            text += `Letter Creation: ${content.letterMethod.tool}\n\n`;
            
            text += "MATERIALS:\n" + content.materials.map(m => `• ${m}`).join("\n") + "\n\n";
            text += "METHODS:\n" + content.methods.map(m => `• ${m}`).join("\n") + "\n\n";
            text += "TIPS:\n";
            
            // Add categorized tips
            if (content.tips.lettering && content.tips.lettering.length > 0) {
                text += "\nLettering: " + content.tips.lettering.join(" | ");
            }
            if (content.tips.construction && content.tips.construction.length > 0) {
                text += "\nConstruction: " + content.tips.construction.join(" | ");
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showNotification('✓ Copied to clipboard!');
            });
        }

        function shareViaEmail() {
            const content = getResultsContent();
            const subject = 'My Banner Creation Guide';
            let body = `Here's my custom banner guide:\n\n`;
            body += `${content.narrative}\n\n`;
            body += `Size: ${content.specs.width.inches}"×${content.specs.height.inches}"\n`;
            body += `Font: ${content.specs.fontSize}\n`;
            body += `Text length: ${content.specs.textRange} characters\n`;
            body += `Letter Creation: ${content.letterMethod.tool}\n\n`;
            body += `Check out the free tool at: https://iancapstick.github.io/bannerapp/banner-tool.html`;
            
            const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.location.href = mailtoLink;
        }

        function restart() {
            currentQuestion = 0;
            answers = {};
            document.getElementById('quiz-container').style.display = 'block';
            document.getElementById('result-container').classList.remove('active');
            
            // Clear all selections
            document.querySelectorAll('.option.selected').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Hide all continue buttons
            document.querySelectorAll('.continue-btn').forEach(btn => {
                btn.classList.remove('show');
            });
            
            showQuestion(0);
        }

        // Send height updates
        window.addEventListener('load', sendHeight);
        window.addEventListener('resize', sendHeight);

        // Initialize when page loads
        initializeQuiz();
    </script>
</body>
</html>
